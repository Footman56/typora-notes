# 个人介绍

面试官，你好，我是裴立志。我面试的是java工程师，我掌握的技能栈有springboot ，dubbo（为其他业务模块提供服务），熟悉使用mysql、redis、elasticsearch、mongodb 数据库。消息队列熟悉 rabbitmq ，了解过分布式缓存。

解决过 服务器内存压力告警，排除原因是慢sql 导致大量数据加载到内存中，解决方式是优化查询语句，增加更多的限制条件。

老年代不回收问题：排除原因是新生代太小，接口比较慢，很容易达到晋升到老年队。解决思路是jvm 堆内存由4G调大16G,并且统计出用时2s以上的慢接口，每月分配随项目上线优化。

个人平时喜欢写文档，在学习一个新知识的时候，喜欢用笔记记录下来。









# 项目经验

项目描述：通过图表形式展示绩效的个人考核，指标考核，我的团队下成员绩效，绩效校准等级分布。
项目实现：elactricsearch+mysql 形式来存储数据，负责数据结构设计，数据查询优化，数据定期校准。
项目效果：查询通常在2s以内返回结果，无慢查询，内存问题。

难点在于：es 与mysql 数据出现不一致的情况。导致的原因是多线程同时操作es的一个文档时导致冲突写失败。

问题原因是：e s采用_seq_no 和 `_primary_term`来实现乐关锁。更新前先查询文档这两个字段，更新操作时携带着两个字段，比较文档的最新值与请求中的是否一致，一致就更新，不一致就跑出异常

解决方式有两个：

1. 晚上空闲时定时将mysql数据同步到es中，根据表中有更新时间再今天内操作的mysql记录，再同步到es中，这个方案不好，因为mysql数据量太大了，并且有好多没必要处理的数据。
2. 在发生同步异常时，将错误的数据记录下来，发送到rabbitmq队列里面，由队列的消费者重新去更新es。 队列的先入先出就能保证一定顺序的。
3. 仍有极特殊情况，这种就是极少数客户反馈过来的，后台开发根据公司纠察接口，并且根据公司刷新es数据的接口
4. 后面思考： 1. 代码书写时尽量将查询es 与更新es的代码接近一点，避免竞争。





面试前几分钟要了解公司薪资，位置，



详细问题：

1. 公司的业务，后续开发做什么工作的，发展行情，技术栈
2. 薪资，加班情况，
3. 不需要关注北京、天津。工作地点都无所谓的







如果是具体问题的话，尽量使用流程图来回答。要有重试机制、错误机制、监控机制。不需要有具体实现的。

模版：针对这个问题，我想以流程图的形式展示。





接口幂等：

1. 提现时生成唯一的token， 返回给前端，前端请求时携带这个to ken， 检查是否有效果，有效就处理，处理完成失效token

2. 数据库唯一索引防重
3. 数据库乐观锁控制字段 （增加版本字段，符合版本才能操作）
4. 分布式锁防止并发 redis 
5. 事物与回滚机制， 插入和更新在一个事务里面
6. 结果缓存和快速响应，缓存这次操作的结果



