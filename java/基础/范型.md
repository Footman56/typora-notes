```java
@Data
public class KpiFieldSettingDO<T> implements Serializable {

    /**
     * 字段选项类型
     * 通过type来区别value 对应的设置
     * @see  EFiledSettingType
     */
    private Integer type;

    /**
     * 字段设置
     * @see List<KpiPoolFieldOptionDO> 计量单位，选项 type=0</KpiPoolFieldOptionDO>
     * @see List<Double> 难度系数 type =1 </>
     * @see String 日期描述 type =2
     */
    private T values;
  
  /***
  * 对values 字段进行修改，
  首先判断 是什么类型，之后就转换成什么类型
  之后在通过 （T） 重新赋值
  **/
  public void removeUnitFixedOption() {
        if (values instanceof List<?>) {
            List<?> tempList = (List<?>) values;
            // 过滤并移除特定的元素
            tempList.removeIf(item -> {
                if (item instanceof KpiPoolFieldOptionDO) {
                    KpiPoolFieldOptionDO poolFieldOptionDO = (KpiPoolFieldOptionDO) item;
                    String optionValue = UNIT_OPTIONS_MAP.get(poolFieldOptionDO.getOptionDesc());
                    // 排除名称相等，并且值相等的选项
                    return StringUtil.isNotEmpty(optionValue) && Objects.equals(poolFieldOptionDO.getOptionValue(), optionValue);
                }
                return false;
            });
            // 由于泛型擦除，这里需要进行强制转换。这里假设values确实是List<KpiPoolFieldOptionDO>类型。
            // 如果不是，这里需要做进一步的类型检查和处理。
            values = (T) new ArrayList<>(tempList);
        } else {
            // values不是List类型，这里可以抛出异常或者进行其他的错误处理
            throw new IllegalStateException("values is not a List type.");
        }
    }
}
```

对保护范型的属性进行反序列化

```java
/**
 * 字段池中 某个字段的配置
 *
 * @author peilizhi
 * @date 2022/6/21 15:26
 **/
@Data
public class KpiPoolFieldSettingTO {

    /**
     * 字段
     */
    private String poolFieldId;

    /**
     * 字段类型
     * 9: 小数位数可变
     */
    private Integer fieldType;

    /**
     * 字段设置
     */
    @JsonDeserialize(using = KpiPoolFieldSettingTODeserializer.class)
    private KpiFieldSettingDO<T> fieldSetting;
}
```

```java
public class KpiPoolFieldSettingTODeserializer extends JsonDeserializer<KpiFieldSettingDO<?>> {
    @Override
    public KpiFieldSettingDO<?> deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException {
        JsonNode node = jp.getCodec().readTree(jp);
        Integer type = node.get("type").asInt();
        JsonNode fieldSettingNode = node.get("values");

        // 根据type类型去反序列化不同的类型
        switch (type) {
            case 0:
                List<KpiPoolFieldOptionDO> listKpiFieldSettingDO = JsonUtil.fromJson(fieldSettingNode.toString(), new TypeReference<List<KpiPoolFieldOptionDO>>() {});
                KpiFieldSettingDO<List<KpiPoolFieldOptionDO>> listFieldSettingDO = new KpiFieldSettingDO<>();
                listFieldSettingDO.setValues(listKpiFieldSettingDO);
                listFieldSettingDO.setType(type);
                return listFieldSettingDO;
            case 1:
                List<Double> doubleKpiFieldSettingDO = JsonUtil.fromJson(fieldSettingNode.toString(), new TypeReference<List<Double>>() {});
                KpiFieldSettingDO<List<Double>> doubleFieldSettingDO = new KpiFieldSettingDO<>();
                doubleFieldSettingDO.setValues(doubleKpiFieldSettingDO);
                doubleFieldSettingDO.setType(type);
                return doubleFieldSettingDO;
            case 2:
                String stingKpiFieldSettingDO = JsonUtil.fromJson(fieldSettingNode.toString(), new TypeReference<String>() {});
                KpiFieldSettingDO<String> stringFieldSettingDO = new KpiFieldSettingDO<>();
                stringFieldSettingDO.setValues(stingKpiFieldSettingDO);
                stringFieldSettingDO.setType(type);
                return stringFieldSettingDO;
            default:
                return null;
        }
    }
}

```

